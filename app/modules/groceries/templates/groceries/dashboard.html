
{% extends "base.html" %}

{% block title %}Groceries{% endblock %}

{% block content %}

<div class="card-dashboard">
    <h2>Shopping List</h2>
    <ul>
        {% for item in shopping_list.items %}
            <li class="shoppinglist-item" data-item-id="{{ item.id }}" data-quantity-wanted="{{ item.quantity_wanted }}">
                <button class="inline-delete" data-action="delete">{{ ui.delete_svg() }}</button>
                <span class="item-text">{{ item.product.name }}</span>
                <span class="qty-controls">
                    <span>&nbsp;&nbsp;&nbsp;--</span>
                    <button data-action="decrement">{{ ui.minus_svg() }}</button>
                    <!-- Wrapper here so quantity+'x' remain one unit (ex: 3x instead of 3 x) -->
                    <span class="item-qty-wrapper">
                        <span class="item-qty">{{ item.quantity_wanted }}</span><span>x</span>
                    </span>
                    <button data-action="increment">{{ ui.plus_svg() }}</button>
                </span>
            </li>
        {% endfor %}
    </ul>
</div>


<div class="card-dashboard">
    <div class="card-header">
        <h2 class="card-title">Grocery - Recent Transactions</h2>
        <a href="{{ url_for('groceries.transactions')}}" class="btn btn-primary">
            Log New Transaction
        </a>
    </div>
    {% call(item, headers) ui.responsive_table('Recent Transactions', transaction_headers, transactions, 'groceries', 'transaction') %}
    <td class="{{ headers[0].priority }}">{{ item.barcode }}</td>
    <td class="{{ headers[1].priority }}">{{ item.product_name }}</td>
    <td class="{{ headers[2].priority }}">{{ item.price_label }}</td>
    <td class="{{ headers[3].priority }}">{{ item.quantity }}</td>
    <td class="{{ headers[4].priority }} text-right">{{ item.created_at_label }}</td>
    <td class="{{ headers[5].priority }} text-right">{{ item.price_per_100g_label }}</td>
    {% endcall %}
</div>

<div class="card-dashboard">
    <div class="card-header">
        <h2 class="card-title">Product Catalog</h2>
        <a href="{{ url_for('groceries.products')}}" class="btn btn-primary">
            Add New Product
        </a>
    </div>
    {% call(item, headers) ui.responsive_table('Product Catalog', product_headers, products, 'groceries', 'product') %}
        <td class="{{ headers[0].priority }}">{{ item.barcode }}</td>
        <td class="{{ headers[1].priority }}">{{ item.name }}</td>
        <td class="{{ headers[2].priority }} text-right">{{ item.category }}</td>
        <td class="{{ headers[3].priority }} text-right">{{ item.net_weight_display }}</td>
        <td class="{{ headers[4].priority }} text-right">{{ item.calories_display }}</td>
    {% endcall %}
</div>
{% endblock %}

{% block scripts %}{% endblock %}