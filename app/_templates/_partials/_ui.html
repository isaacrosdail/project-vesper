{# _macros.html - Style macros for consistent styling across templates #}
{# <!--
REMEMBER:
If we're defining reusable batch styles → style.css (.input-standard, .form-group)
If we're defining reusable COMPONENTS (with structure/behavior/logic) → here ({{ form_input() }}, {{ card() }})
  - Components = HTML structure + behavior + logic
  - Styles = just CSS classes
--> #}

{#
    Notes for custom modals: Keyboard nav, aria-label param,    
#}


{# Responsive Tables #}

{% macro responsive_table(caption, headers, items, module_name, subtype) %}
<table id="{{ subtype }}-table" class="table-standard">
  <caption class="_sr-only">{{ caption }}</caption>
  <thead class="table-header">
    <tr>
      {% for col in headers %}
        <th class="{{ col.priority }}">{{ col.label }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% if items %}
      {% for item in items %}
        <tr class="table-row" data-item-id="{{ item.id }}" data-module="{{ module_name }}" data-subtype="{{ subtype }}">
          {{ caller(item, headers) }}
          <td class="table-cell delete-cell">
            {{ delete_btn() }}
          </td>
        </tr>
      {% endfor %}
    {% else %}
        <tr>
          <td colspan="99" class="table-empty">
            No entries yet.
          </td>
        </tr>
    {% endif %}
  </tbody>
</table>
{% endmacro %}


{# === MODALS === #}

{# Entry form modal #}

{# caller() segment here lets us put whatever 'insides' we want in our modals #}
{# by sandwiching them between 'call ourmacro(ourparameters,..)' and 'endcall' #}
{# TODO: NOTES: {% call %} doesn't work with a template that doesn't use caller() #}
{% macro modal(endpoint, id, title) %}
<dialog id="{{ id }}-modal" data-endpoint="/{{ endpoint }}">
    <form>
        <legend>{{ title }}</legend>
        <button type="button" class="modal-close btn btn-destructive" id="{{ id }}-modal-close-btn">&times;</button>
        {{ caller() }}
        <button type="submit" class="btn btn-primary">Save</button>
    </form>
</dialog>
{% endmacro %}


{# Confirmation Modal #}

{% macro confirmation_modal() %}
<dialog id="confirmation-modal">
  <div class="confirmation-content">
    <p class="confirmation-message">Are you sure?</p>
    <div class="form-actions">
      <button id="confirm-cancel" class="btn btn-secondary">Cancel</button>
      <button id="confirm-ok" class="btn btn-primary">OK</button>
    </div>
  </div>
</dialog>
{% endmacro %}


{# Toast Container #}

{% macro toast_container() %}
<div id="toast-container"></div>
{% endmacro %}

{# === LINKS === #}

{# Link for returning from error page(s) #}

{% macro error_link(text, endpoint) %}
<a href="{{ url_for(endpoint) }}"
    class="error-link btn btn-primary">
    {{ text }}
</a>
{% endmacro %}


{# === BUTTON COMPONENTS === #}

{# Note: btn btn-destructive for styling (color & cursor), delete-btn for our JS event listener #}
{% macro delete_btn() %}
<button aria-label="Delete item" class="btn btn-destructive delete-btn">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4" aria-hidden="true">
        <title></title>
        <path fill-rule="evenodd" d="M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z" clip-rule="evenodd" />
    </svg>
</button>
{% endmacro %}

{# Plus/Minus SVGs #}

{% macro plus_svg() %}
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M6 12H18M12 6V18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>
{% endmacro %}

{% macro minus_svg() %}
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M6 12H18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>
{% endmacro %}

{% macro delete_svg() %}
<svg xmlns="http://www.w3.org/2000/svg"  fill="currentColor"  viewBox="0 0 24 24">
  <path d="M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.89 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.89a1 1 0 0 0 1.41-1.41L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4z"/>
</svg>
{% endmacro %}
