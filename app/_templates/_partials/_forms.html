
{% import '_partials/_ui.html' as ui %}

{# Form Modals - Specific Ones #}

{% macro metric_entry_modal(id='daily_entries-entry-dashboard', title='Add Metric', entry_date=None) %}
  {% call ui.modal('metrics', 'daily_entries', id, title) %}
      {# Entry date outside tabs, only required field #}
      <div class="form-group entry-date-field">
        <label for="entry_datetime">Entry Date:</label>
        <input type="date" id="entry_datetime" name="entry_datetime" required
                {% if entry_date %}value="{{ entry_date }}"{% endif %}
        >
      </div>
      <div class="tab-group">
        <button type="button" role="tab" data-tab="steps" class="tab">{{ ui.steps_svg() }} Steps</button>
        <button type="button" role="tab" data-tab="weight" class="tab">{{ ui.scale_svg() }} Weight</button>
        <button type="button" role="tab" data-tab="sleep" class="tab">{{ ui.sleep_svg() }} Sleep</button>
        <button type="button" role="tab" data-tab="calories" class="tab">{{ ui.calories_svg() }} Calories</button>
      </div>

      <div role="tabpanel" class="tab-content" id="tab-steps">
          <label for="steps">Steps:</label>
          <input type="number" id="steps" name="steps" min="0" max="40000" step="1">
      </div>
      <div role="tabpanel" class="tab-content" id="tab-weight" hidden>
          <label for="weight">Weight:</label>
          <input type="number" id="weight" name="weight" min="0" max="500" step="0.1">
      </div>
      <div role="tabpanel" class="tab-content" id="tab-calories" hidden>
          <label for="calories">Calories:</label>
          <input type="number" id="calories" name="calories" min="0" max="10000" step="1">
      </div>
      <div role="tabpanel" class="tab-content" id="tab-sleep" hidden>
        <div>
          <label for="wake_time">Wake Time:</label>
          <input type="time" id="wake_time" name="wake_time">
        </div>
        <div>
          <label for="sleep_time">Sleep Time:</label>
          <input type="time" id="sleep_time" name="sleep_time">
        </div>
      </div>
  {% endcall %}
{% endmacro %}


{% macro time_entry_modal(id='time_entries-entry-dashboard', title='Add Time Entry', current_date=None) %}
  {% call ui.modal('time_tracking', 'time_entries', id, title) %}
    <div>
        <label for="category">Category:</label>
        <input type="text" id="category" name="category" required>
    </div>
    <div>
        <label for="entry_date">Date: </label>
        <input type="date" id="entry_date" name="entry_date" value="{{ current_date }}" required>
    </div>
    <div>
        <label for="duration_minutes">Duration (minutes):</label>
        <input type="number" id="duration_minutes" name="duration_minutes" min="0" required>
    </div>
    <div>
        <label for="started_at">Started At:</label>
        <input type="time" id="started_at" name="started_at" required>
    </div>
    <div>
        <label for="description">Description (Optional):</label>
        <input type="text" id="description" name="description">
    </div>
  {% endcall %}
{% endmacro %}

{% macro task_entry_modal(id='tasks-entry-dashboard', title='Add Task') %}
  {% call ui.modal('tasks', 'tasks', id, title) %}
    <div>
      <label for="name">Task:</label>
      <input type="text" id="name" name="name" required>
    </div>
    <div>
      <label for="priority">Priority</label>
      <select name="priority" id="priority">
        <option value="">--</option>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
      </select>
    </div>
      <input type="checkbox" id="is_frog" name="is_frog">
      <label for="is_frog">"Daily Frog" Task?</label>
    <div>
      <label for="due_date">Due:</label>
      <input type="date" id="due_date" name="due_date">
    </div>
  {% endcall %}
{% endmacro %}

{% macro habit_entry_modal(id='habits-entry-dashboard', title='Add Habit') %}
    {% call ui.modal('habits', 'habits', id, title) %}
        <div>
            <label for="name">Habit:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div>
            <label for="is_promotable">Promotion-based?</label>
            <input type="checkbox" id="is_promotable" name="is_promotable">
        </div>
    {% endcall %}
{% endmacro %}

{% macro leetcode_entry_modal(id='leet_code_records-entry-homepage', title='Add LeetCode record') %}
    {% call ui.modal('habits', 'leetcode_records', id, title) %}
        <div>
            <label for="leetcode_id">LeetCode Problem ID:</label>
            <input type="number" id="leetcode_id" name="leetcode_id" min="1" step="1" required>
        </div>
        <fieldset class="radio-row">
            <legend>Difficulty:</legend>
            <div>
                <input type="radio" id="easy" name="difficulty" value="easy" checked>
                <label for="easy">Easy</label>
            </div>
            <div>
                <input type="radio" id="medium" name="difficulty" value="medium">
                <label for="medium">Medium</label>
            </div>
            <div>
                <input type="radio" id="hard" name="difficulty" value="hard">
                <label for="hard">Hard</label>
            </div>
        </fieldset>
        <div>
            <label for="language">Language Used:</label>
            <select name="language" id="language">
                <option value="Python">Python</option>
                <option value="JavaScript">JavaScript</option>
                <option value="C">C</option>
                <option value="C++">C++</option>
            </select>
        </div>
        <fieldset class="radio-row">
            <legend>Status:</legend>
            <div>
                <input type="radio" id="solved" name="lcstatus" value="solved" checked>
                <label for="solved">Solved</label>
            </div>
            <div>
                <input type="radio" id="attempted" name="lcstatus" value="attempted">
                <label for="attempted">Attempted</label>
            </div>
            <div>
                <input type="radio" id="reviewed" name="lcstatus" value="reviewed">
                <label for="reviewed">Reviewed</label>
            </div>
        </fieldset>
    {% endcall %}
{% endmacro %}

{% macro product_entry_modal(id='products-entry-dashboard', title='Add Product') %}
    {% call ui.modal('groceries', 'products', id, title) %}
        <div>
            <label for="name">Product Name:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div>
            <label for="barcode">Barcode:</label>
            <input type="text" id="barcode" name="barcode"
                minlength="8" maxlength="14"
                pattern="[0-9]{8,14}"
                placeholder="Scan or enter barcode">
        </div>
        <div>
            <label for="category">Category</label>
            <select name="category" id="category" required>
                <option value="" disabled selected>-- Category --</option>
                <option value="fruits">Fruits</option>
                <option value="vegetables">Vegetables</option>
                <option value="legumes">Legumes</option>
                <option value="grains">Grains</option>
                <option value="bakery">Bakery</option>
                <option value="dairy_eggs">Dairy & Eggs</option>
                <option value="meats">Meats</option>
                <option value="seafood">Seafood</option>
                <option value="fats_oils">Fats & Oils</option>
                <option value="snacks">Snacks</option>
                <option value="sweets">Sweets</option>
                <option value="beverages">Beverages</option>
                <option value="condiments_sauces">Condiments & Sauces</option>
                <option value="processed_convenience">Processed/Convenience</option>
                <option value="supplements">Supplements</option>
            </select>
        </div>
        <div>
            <label for="net_weight">Net Weight:</label>
            <input type="number" step="0.01" min="0" id="net_weight" name="net_weight" required>
        </div>
        <div>
            <label for="unit_type">Units:</label>
            <select name="unit_type" id="unit_type" required>
                <option value="" disabled selected>-- Units --</option>
                <option value="g">g (grams)</option>
                <option value="kg">kg (kilograms)</option>
                <option value="oz">oz (ounces)</option>
                <option value="lb">lb (pounds)</option>
                <option value="ml">ml (milliliters)</option>
                <option value="l">l (liters)</option>
                <option value="fl_oz">fl oz (fluid ounces)</option>
            </select>
        </div>
        <div>
            <label for="calories_per_100g">Cals per 100g:</label>
            <input type="number" step="0.01" min="0" max="900" id="calories_per_100g" name="calories_per_100g">
        </div>
    {% endcall %}
{% endmacro %}

{% macro transaction_entry_modal(products, id='transactions-entry-dashboard', title='Add Transaction') %}
    {% call ui.modal('groceries', 'transactions', id, title) %}
        <div>
            <label for="product_id">Select Product: </label>
            <select name="product_id" id="product_id" required>
                <option value="">--</option>
                {% for product in products %}
                    <option value="{{ product.id }}">{{ product.name }}</option>
                {% endfor %}
                <option value="__new__">+ Create New Product</option>
            </select>
        </div>

        <div>
            <label for="price_at_scan">Price (each):</label>
            <input type="number" step="0.01" min="0" id="price_at_scan" name="price_at_scan"
                value="{{ transaction_data.price_at_scan if transaction_data else '' }}"
                required>
        </div>
        <div>
            <label for="quantity">Quantity:</label>
            <input type="number" step="1" min="1" id="quantity" name="quantity"
                value="{{ transaction_data.quantity if transaction_data else '' }}"
                required>
        </div>
        <div class="product-field" hidden>
            <label for="name">Product Name</label>
            <input type="text" id="name" name="name" disabled>
        </div>
        <div class="product-field" hidden>
            <label for="barcode">Barcode:</label>
            <input type="text" id="barcode" name="barcode"
                value="{{ transaction_data.barcode if transaction_data else ''}}"
                minlength="8" maxlength="14"
                placeholder="Scan or enter barcode">
        </div>
        <div class="product-field" hidden>
            <label for="category">Category</label>
            <select name="category" id="category" disabled>
                <option value="" disabled selected>-- Category --</option>
                <option value="fruits">Fruits</option>
                <option value="vegetables">Vegetables</option>
                <option value="legumes">Legumes</option>
                <option value="grains">Grains</option>
                <option value="bakery">Bakery</option>
                <option value="dairy_eggs">Dairy & Eggs</option>
                <option value="meats">Meats</option>
                <option value="seafood">Seafood</option>
                <option value="fats_oils">Fats & Oils</option>
                <option value="snacks">Snacks</option>
                <option value="sweets">Sweets</option>
                <option value="beverages">Beverages</option>
                <option value="condiments_sauces">Condiments & Sauces</option>
                <option value="processed_convenience">Processed/Convenience</option>
                <option value="supplements">Supplements</option>
            </select>
        </div>
        <div class="product-field" hidden>
            <label for="net_weight">Net Weight:</label>
            <input type="number" step="0.01" min="0" id="net_weight" name="net_weight" disabled>
        </div>
        <div class="product-field" hidden>
            <label for="unit_type">Units:</label>
            <select name="unit_type" id="unit_type" disabled>
                <option value="" disabled selected>-- Units --</option>
                <option value="g">g (grams)</option>
                <option value="kg">kg (kilograms)</option>
                <option value="oz">oz (ounces)</option>
                <option value="lb">lb (pounds)</option>
                <option value="ml">ml (milliliters)</option>
                <option value="l">l (liters)</option>
                <option value="fl_oz">fl oz (fluid ounces)</option>
            </select>
        </div>
        <div class="product-field" hidden>
            <label for="calories_per_100g">Cals per 100g:</label>
            <input type="number" step="0.01" min="0" max="900" id="calories_per_100g" name="calories_per_100g" disabled>
        </div>
    {% endcall %}
{% endmacro %}