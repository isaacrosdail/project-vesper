{# Main Dashboard UI #}

{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content_mod %}content--narrow{% endblock %}

{% block content %}

{# Modals #}
{{ forms.task_entry_modal('task-entry-homepage', 'Add Task') }}
{{ forms.habit_entry_modal('habit-entry-homepage', 'Add Habit') }}
{{ forms.metric_entry_modal('metric-entry-homepage', 'Add Metric Entry') }}
{{ forms.time_entry_modal('time-entry-homepage', 'Add Time Entry') }}
{{ forms.leetcode_entry_modal() }}

{# Greeting & Time/Date Card #}
<section id="greeting-card" class="card-dashboard">
    <div class="time-section">
        <h2 class="card-title">
            {% if current_user.is_authenticated %}
                {{ greeting }}, {{ current_user.name }}!
            {% else %}
                {{ greeting }}
            {% endif %}
        </h2>
        <p><span id="time-display">{{ now_time }}</span> | {{ now_date }}</p>
    </div>
    <div class="weather-section">
        <div id="weather-temp"></div>
        <div id="weather-sunset"></div>
        <canvas id="sky-canvas"></canvas>
    </div>

</section>

{# "My Day" Card #}
<section id="my-day-card" class="card-dashboard">
    <div class="card-title">
        <h2>My Day</h2>
        {{ ui.plus_btn('task-entry-homepage-btn', 'Add Task') }}
    </div>

    <div>
        <span class="highlight-label">Today's Frog: </span>
        <span>
            {{ today_frog.name if today_frog else "" }}
        </span>
        <ul class="item-list">
        {% for task in tasks %}
            <li class="item {% if task.is_done %}completed{% endif %}">
                <label class="item-row">
                    <input  type="checkbox" class="task-checkbox" data-task-id="{{ task.id }}"
                        {% if task.is_done %}checked{% endif %}>
                    <span class="item-title">{{ task.name }}</span>
                </label>
            </li>
        {% endfor %}
        </ul>
    </div>

    <div>
        <button class="btn btn-primary" id="time-entry-homepage-btn">Add Time Entry</button>
        <button class="btn btn-primary" id="metric-entry-homepage-btn">Add Metric Entry</button>
    </div>

</section>

{# Daily Habits Card #}
<section id="daily-habits-card" class="card-dashboard">
    <div class="card-title">
        <h2>Daily Habits</h2>
        {{ ui.plus_btn('habit-entry-homepage-btn', 'Add Habit') }}
    </div>
    <div>
        <!-- Leetcode thing -->
        <div class="card-highlight">
            <span class="highlight-label">LeetCode: </span>
            <span class="editable-cell">{{ leetcode_records[0].id if leetcode_records else "EXAMPLE" }}</span>
            <button id="leetcode-entry-homepage-btn" class="btn btn-primary">Add Record</button>
        </div>


        <ul class="item-list">
        {% for habit in habits %}
            <li class="item {% if habit_info[habit.id].completed_today %}completed{% endif %}">
                <label class="item-row">
                    <input  type="checkbox" class="habit-checkbox" data-habit-id="{{ habit.id }}"
                        {% if habit_info[habit.id].completed_today %}checked{% endif %}>
                    <span class="item-title">{{ habit.name }}</span>
                    <span class="habit-streak" data-streak-count="{{ habit_info[habit.id].streak_count }}">
                        {% if habit_info[habit.id].streak_count > 0 %}ðŸ”¥{{ habit_info[habit.id].streak_count }}{% endif %}
                    </span>
                </label>
            </li>
        {% endfor %}
        </ul>
    </div>
    <div class="d3-container">
        <!-- TODO: Add -->
    </div>
</section>

{% endblock %}

{% block scripts %}{% endblock %}