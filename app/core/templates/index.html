{# Main Dashboard UI #}

{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content_mod %}content--narrow{% endblock %}

{% block content %}
{# Greeting & Time/Date Card #}
<section id="greeting-card" class="card-dashboard">
    <div class="time-section">
        <h2 class="card-title">
            {% if current_user.is_authenticated %}
                {{ greeting }}, {{ current_user.name }}!
            {% else %}
                {{ greeting }}
            {% endif %}
        </h2>
        <p><span id="time-display">{{ now_time }}</span> | {{ now_date }}</p>
    </div>
    <div class="divider"></div>
    <div class="weather-section">
        <div id="weather-temp"></div>
        <div id="weather-sunset"></div>
        <canvas id="sun-canvas" width="200" height="100"></canvas>
    </div>

</section>

{# Critical Task Card #}
<section id="today-intention-card" class="card-dashboard">
    <h2 class="card-title">Critical Task</h2>
    <p>
        <span>Today's Intention: </span>
        <span id="intention-text" class="placeholder-text">
            {{ today_intention.intention if today_intention.intention else "FAIL" }}
        </span>
    </p>
</section>

{# Daily Habits Card #}
<section id="daily-habits-card" class="card-dashboard">
    <h2 class="card-title">Daily Habits</h2>
    <ul class="habit-list">
    {% for habit in habits %}
        <li class="habit-item {% if habit_info[habit.id].completed_today %}completed{% endif %}">
            <label class="habit-row">
                <input 
                    type="checkbox"
                    class="habit-checkbox"
                    data-habit-id="{{ habit.id }}"
                    {% if habit_info[habit.id].completed_today %}checked{% endif %}>

                <span class="habit-title">{{ habit.name }}</span>
                <span class="habit-streak" data-streak-count="{{ habit_info[habit.id].streak_count }}">
                    {% if habit_info[habit.id].streak_count > 0 %}ðŸ”¥{{ habit_info[habit.id].streak_count }}{% endif %}
                </span>
            </label>
        </li>
    {% endfor %}
    </ul>
</section>

{# Daily Check-In Card #}
{# TODO: Scrap our 'data-' things in this card. Used more for storing custom data on elements not for grabbing them #}
<section id="daily-check-in-card" class="card-dashboard">
    <h2 class="card-title">Daily Check-In</h2>
    {# Content: weight, steps, movement (mins), stress (scale), energy (scale) #}

    <div class="form-group">
        <label for="weight">Weight:</label>
        <input class="input-inline" type="number" id="weight" min="0" max="500" step="0.1" name="weight" data-metric="weight" data-unit="lbs" placeholder="lbs">
    </div>
    <div class="form-group">
        <label for="steps">Steps:</label>
        <input class="input-inline" type="number" id="steps" min="0" max="100000" step="1" name="steps" data-metric="steps" data-unit="steps" placeholder="0">
    </div>
    {# TODO: Compute duration from these #}
    <div class="form-group">
        <label for="sleep_time">Sleep</label>
        <input class="input-inline" type="time" id="sleep_time" name="sleep_time">
    </div>
    <div class="form-group">
        <label for="wake_time">Wake</label>
        <input class="input-inline" type="time" id="wake_time" name="wake_time">
    </div>
    <div class="form-group">
        <label for="calories">Calories</label>
        <input class="input-inline" type="number" id="calories" min="0" max="10000" step="1" name="calories">
    </div>
</section>

{# Activity Log Entry Card #}
<section id="activity-log-card" class="card-dashboard">
    <button class="btn btn-primary" id="time-entry-homepage-btn">Add Time Entry</button>
    {% call ui.modal('time-entry-homepage', 'Add Time Entry') %}
        <div class="form-group">
            <label for="category">Category:</label>
            <input type="text" id="category" name="category">
        </div>
        <div class="form-group">
            <label for="duration">Duration:</label>
            <input type="number" id="duration" name="duration" min="0">
        </div>
        <div class="form-group">
            <label for="started_at">Started At:</label>
            <input type="time" id="started_at" name="started_at">
        </div>
        <div class="form-group">
            <label for="description">Description (Optional):</label>
            <input type="text" id="description" name="description">
        </div> 
    {% endcall %}
</section>

{% endblock %}

{% block scripts %}{% endblock %}